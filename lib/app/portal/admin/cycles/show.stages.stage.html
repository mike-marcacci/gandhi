<div class="row">

	<div class="col-sm-7">
		<div gandhi-component="{cycle: cycle, project: project, stage: stage, mode: 'stageAdmin'}"></div>
	</div>

	<div class="col-sm-5">

		<div class="panel panel-default">
			<div class="panel-heading">
				<span class="panel-title">Visibility</span>
				<div class="pull-right">
					<button class="btn btn-xs btn-primary" ng-click="updateVisibility()" ng-if="editVisibility">Save</button>
					<button class="btn btn-xs" ng-show="update" ng-class="{'btn-default': true, 'active': editVisibility}" ng-click="toggleVisibility()"><i class="glyphicon glyphicon-cog"></i></button>
				</div>
			</div>
			<form ng-submit="updateVisibility()">
				<table class="table">
					<thead>
						<tr>
							<th>Role</th>
							<th>Visible</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="role in roles">
							<th>{{role.title}}</th>
							<td>
								<gandhi-permission edit="editVisibility" ng-model="stage.visible[role.id]" triggers="triggersById" role="role"></gandhi-permission>
							</td>
						</tr>
					</tbody>
				</table>
			</form>
		</div>

		<div class="panel panel-default">
			<div class="panel-heading">
				<span class="panel-title">Permissions</span>
				<div class="pull-right">
					<button class="btn btn-xs btn-primary" ng-click="updateComponentPermissions()" ng-if="editComponentPermissions">Save</button>
					<button class="btn btn-xs" ng-show="update" ng-class="{'btn-default': true, 'active': editComponentPermissions}" ng-click="toggleComponentPermissions()"><i class="glyphicon glyphicon-cog"></i></button>
				</div>
			</div>
			<form ng-submit="updateComponentPermissions()">
				<gandhi-permissions edit="editComponentPermissions" permissions="component.permissions" roles="rolesById" triggers="triggersById" ng-model="stage.component.permissions"></gandhi-permissions>
			</form>
		</div>
	</div>

</div>
